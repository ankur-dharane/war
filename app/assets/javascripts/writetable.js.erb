var IDClicked = -1;

var StringClicked = "";

var FinalClick = ""

var FinalClickint = -1;

var totalpoints = 0;
var attackspeedint = 0;
var accuracyint = 0;
var speedint = 0;
var attackdamageint = 0;
var defenseint = 0;
var index  = 0;
//var Arrayids = new Array(0);
var Arrayids1 = new Array(0);
var Arrayids = {};
Arrayids = document.getElementById("Arrayids").innerHTML;
Arrayids = JSON.parse(Arrayids)

//alert(Arrayids)
for (i = 4; i < 30; i = i + 3)
{
  Arrayids1[index] = Arrayids[i]
  index = index + 1
}
for (i = 31; i < Arrayids.length; i = i + 4)
{
  Arrayids1[index] = Arrayids[i] + Arrayids[i+1];
  index = index + 1
}
var remelem = Arrayids1.indexOf("\nundefined")
Arrayids1.splice(remelem,1)
//Arrayids = Arrayids1
var AA = document.getElementById("AA").innerHTML;

AA = parseInt(AA,10);

var BB = document.getElementById("BB").innerHTML;

BB = parseInt(BB,10);

var CC = document.getElementById("CC").innerHTML;

CC = parseInt(CC,10);

var DD = document.getElementById("DD").innerHTML;

DD = parseInt(DD,10);

var Sum = AA + BB + CC + DD


var ArrayElem = new Array(15);

var counter = 0;

for (i = 0; i < AA; i++)
{
	ArrayElem[i] = "A"
	counter = counter + 1
}

for (i = counter; i < BB + AA; i++)
{
	ArrayElem[i] = "B"
	counter = counter + 1
}

for (i = counter; i < CC + BB + AA; i++)
{
	ArrayElem[i] = "C"
	counter = counter + 1
}

for (i = counter; i < DD + CC + BB + AA; i++)
{
	ArrayElem[i] = "D"
	counter = counter + 1
}
counter = 0;

function FunctionSubmit(clicked_id)
{
	//alert("it is submitted");
	FinalClick = clicked_id.slice(-1) + "";
  FinalClickint = parseInt(FinalClick,10);
  //alert(FinalClick);
	var attackspeed = document.getElementById("attackspeed" + FinalClick + "").value;
	 attackspeedint = parseInt(attackspeed,10);
	//var attackspeedfloat = parseFloat(attackspeed)

	var accuracy = document.getElementById("accuracy" + FinalClick + "").value;
	 accuracyint = parseInt(accuracy,10);
	//var accuracyfloat = parseFloat(accuracy);

	var speed = document.getElementById("speed" + FinalClick + "").value;
	 speedint = parseInt(speed,10);
	//var speedfloat = parseFloat(speed);

	var attackdamage = document.getElementById("attackdamage" + FinalClick + "").value;
	 attackdamageint = parseInt(attackdamage,10);
	//var attackdamagefloat = parseFloat(attackdamage,10);

	var defense = document.getElementById("defense" + FinalClick + "").value
	 defenseint = parseInt(defense,10);
	//var defensefloat = parseFloat(defense);


//	if (isNaN(attackspeedint) || attackspeedint != attackspeedfloat)
//	{
//		alert("The attack speed should be an integer");
//		return;
//	}

//	if (isNaN(accuracyint) || accuracyint != accuracyfloat)
//	{
//		alert("The accuracy should be an integer");
//		return;
//	}

//	if (isNaN(speedint) || speedint != speedfloat)
//	{
//		alert("The speed should be an integer");
//		return;
//	}

//	if (isNaN(attackdamageint) || attackdamageint != attackdamagefloat)
//	{
//		alert("The attack damage should be an integer");
//		return;
//	}

//	if (isNaN(defenseint) || defenseint != defensefloat)
//	{
//		alert("The defense should be an integer");
//		return;
//	}
	totalpoints = 0;
	totalpoints = attackspeedint + accuracyint + speedint + attackdamageint + defenseint;

	if (totalpoints < 15 || totalpoints > 15)
	{
		alert("You got only 15 points, the total points must be equal 15");
		return;
	}

	else
	{
		$('#dialog' + FinalClick).dialog('close');
    var idd = "id"
    FinalClick =  idd.concat(FinalClick); 
    //alert(document.getElementById("final_id"+FinalClickint).innerHTML)

		$.ajax({type: "GET", 
                            cache: false,
                            contentType: 'application/html; charset=utf-8',
                            url: "/createpoint", 
                            dataType: "html",
                             data: { attack_speed: attackspeedint, accuracy: accuracyint, speed: speedint, attack_damage: attackdamageint, defense: defenseint, clicked_id: FinalClickint, unit_id: document.getElementById("final_id"+FinalClickint).innerHTML},
                             success: function (result) {
            					//window.location.replace("http://localhost:3000/table_wars/new");
          					 alert("You have successfuly created a unit");
        						}
                            
                        });
		
	} 

	console.log("attack speed is " + attackspeed);
}

function myFunction(clicked_id)
{
	if (document.getElementById(clicked_id).style.backgroundColor == "red")
	{
		document.getElementById(clicked_id).style.backgroundColor = ""
		IDClicked = -1;
	}

	else 
	{
		document.getElementById(clicked_id).style.backgroundColor = "red"
		IDClicked = clicked_id;
	}
	

	for (i = 0; i < Sum; i++)
	{
		if (i == clicked_id)
		{


			
		}
		else
		{
			if (document.getElementById(i).style.backgroundColor == "red")
			{

				document.getElementById(i).style.backgroundColor = ""
			}
		}
	} 


}

function AddButton(clicked_id)
{
	console.log("ID clicked is " + IDClicked)

	console.log("Document is " + document.getElementById(clicked_id).innerHTML)

	var coc = 0;

	if (document.getElementById(clicked_id).innerHTML)
	{
		cc = 1
	}

	else

	{
		cc = 2
	}
	console.log("length is " + document.getElementById(clicked_id).innerHTML.length)

	if (IDClicked != -1 && document.getElementById(clicked_id).innerHTML.length > 0)
	{

		alert("kda est3bat")

		return

	}
	if (IDClicked == -1 && document.getElementById(clicked_id).innerHTML.length == 0)
	{

		alert("You have not selected any defense units yet")
	
	}

	else if (IDClicked == -1 && document.getElementById(clicked_id).innerHTML.length != 0)
	{

		//alert("You can edit it :)")
		

		//var x;

		//var person = prompt("Attackspeed\nAccuracy", "attack speed\nAccuracy");

		//if (person!=null)
  			//{
  				//Attack Speed 
  				//Accuracy 
  				//Speed 
  				//Attack Damage 
  				//Defence 
  				//Number of soldiers
  				
  				
  			//}

  			//document.write('<div id = "dialog">');
  			//document.write('<div> Attack Speed </div>');
  			//document.write('<textarea id ="attackspeed"></textarea>');
  			//document.write('</div>');
  			//var StringClicked = "";
  			StringClicked = clicked_id +"";
  			StringClicked = StringClicked.slice(-1) + "";
        var trial = document.getElementById("final_id"+StringClicked).innerHTML
        //alert("Unit id is " + trial)
  			$(function(){$("#dialog" + StringClicked).dialog();$("#dialog" + StringClicked).dialog("open");});
    		StringClicked = "";
	}
	else
	{

		var Value = document.getElementById(IDClicked).innerHTML
		document.getElementById(clicked_id).innerHTML = Value
    var hereclick = clicked_id.slice(-1)
    document.getElementById("final_id"+hereclick+"").innerHTML = document.getElementById("idd"+IDClicked+"").innerHTML
		document.getElementById(IDClicked).style ="visibility: hidden"
		document.getElementById(IDClicked).style.backgroundColor = ""
		IDClicked = -1

	}

}

var BooleanButtons = new Array(15);


for (i = 0; i < BooleanButtons.length; i++)
{
	BooleanButtons[i] = false
}

var counter = -1;

document.write('<div>')

document.write('<div class = "alldefenseclass">')

for(i = 0; i < 8; i++)
{
	document.write('<div class = "groupdivclass">')
	for (j = 0; j < 2; j++)
	{
			counter = counter + 1;
		if (i == 7 & j == 1)
		{
			break
		}
    if (ArrayElem[counter] !== undefined)
    {
     
    }
    else
    {
       break;
    }
    document.write('<div id = '+"idd"+counter+' style = "display:none">'+Arrayids[counter]+"")
    document.write("</div>")
		document.write('<button onclick = "myFunction(this.id)"+ id =' + counter+"" + '>' +ArrayElem[counter]+'</button>')
	}
  document.write('</div>')
    if (ArrayElem[counter] !== undefined)
    {
     
    }
    else
    {
      break;
    }
	
}

	

document.write('</div>')


document.write('<table border="1" cellspacing="1" cellpadding="5" class = "tableclass" width = "400" height = "400">')
counter = -1;
for(i = 0; i < 4; i++){
	document.write('<tr>')
	for(j = 0; j < 4; j++ )
	{
		counter = counter + 1
    document.write('<div id = ' + "final_id"+counter+""+' style = "display:none">')
    document.write("</div>")
   		document.write('<td> <button id = ' + "id" + counter+"" + ' class = "allbuttonsclass"  onclick = "AddButton(this.id)"></button> </td>')
   		
	}
	document.write('</tr>')
   
}

document.write('</table>')

document.write('</div>')

var Arrayexistunit = document.getElementById("Arrayfoundunit").innerHTML;
Arrayexistunit = JSON.parse(Arrayexistunit)

var Arrayexistclick = document.getElementById("Arrayfoundclick").innerHTML;
Arrayexistclick = JSON.parse(Arrayexistclick)

//alert(Arrayexistclick)

var Arrayexistname = document.getElementById("Arrayfoundname").innerHTML;

Arrayexistname = JSON.parse(Arrayexistname)
for (i = 0 ; i < Arrayexistclick.length; i++)
{
  document.getElementById("id" + Arrayexistclick[i]).innerHTML = Arrayexistname[i]
  document.getElementById("final_id" + Arrayexistclick[i]).innerHTML = Arrayexistunit[i]
}



for (i = 0; i < 16; i++)
{

			document.write('<div id = ' + "dialog" + i + "" + ' style = "display:none">');
  			document.write('<div> Attack Speed </div>');
  			document.write('<select id = ' + "attackspeed" + i + "" + '>')
  			document.write('<option value="1">1</option>')
  			document.write('<option value="2">2</option>')
  			document.write('<option value="3">3</option>')
  			document.write('<option value="4">4</option>')
  			document.write('<option value="5">5</option>')
  			document.write('<option value="6">6</option>')
  			document.write('<option value="7">7</option>')
  			document.write('<option value="8">8</option>')
  			document.write('<option value="9">9</option>')
  			document.write('<option value="10">10</option>')
  			document.write('<option value="11">11</option>')
  			document.write('<option value="12">12</option>')
  			document.write('<option value="13">13</option>')
  			document.write('<option value="14">14</option>')
  			document.write('<option value="15">15</option>')
  			document.write("</select>")
  			//document.write('<input id = ' + "attackspeed" + i + "" + ' type = "text" />');
  			document.write('<div> Accuracy </div>');
  			document.write('<select id = ' + "accuracy" + i + "" + '>')
  			document.write('<option value="1">1</option>')
  			document.write('<option value="2">2</option>')
  			document.write('<option value="3">3</option>')
  			document.write('<option value="4">4</option>')
  			document.write('<option value="5">5</option>')
  			document.write('<option value="6">6</option>')
  			document.write('<option value="7">7</option>')
  			document.write('<option value="8">8</option>')
  			document.write('<option value="9">9</option>')
  			document.write('<option value="10">10</option>')
  			document.write('<option value="11">11</option>')
  			document.write('<option value="12">12</option>')
  			document.write('<option value="13">13</option>')
  			document.write('<option value="14">14</option>')
  			document.write('<option value="15">15</option>')
  			document.write("</select>")
  			//document.write('<input id = ' + "accuracy" + i + "" + ' type = "text" />');
  			document.write('<div> Speed </div>');
  			document.write('<select id = ' + "speed" + i + "" + '>')
  			document.write('<option value="1">1</option>')
  			document.write('<option value="2">2</option>')
  			document.write('<option value="3">3</option>')
  			document.write('<option value="4">4</option>')
  			document.write('<option value="5">5</option>')
  			document.write('<option value="6">6</option>')
  			document.write('<option value="7">7</option>')
  			document.write('<option value="8">8</option>')
  			document.write('<option value="9">9</option>')
  			document.write('<option value="10">10</option>')
  			document.write('<option value="11">11</option>')
  			document.write('<option value="12">12</option>')
  			document.write('<option value="13">13</option>')
  			document.write('<option value="14">14</option>')
  			document.write('<option value="15">15</option>')
  			document.write("</select>")
  			//document.write('<input id = ' + "speed" + i + "" + ' type = "text" />');
  			document.write('<div> Attack Damage</div>');
  			document.write('<select id = ' + "attackdamage" + i + "" + '>')
  			document.write('<option value="1">1</option>')
  			document.write('<option value="2">2</option>')
  			document.write('<option value="3">3</option>')
  			document.write('<option value="4">4</option>')
  			document.write('<option value="5">5</option>')
  			document.write('<option value="6">6</option>')
  			document.write('<option value="7">7</option>')
  			document.write('<option value="8">8</option>')
  			document.write('<option value="9">9</option>')
  			document.write('<option value="10">10</option>')
  			document.write('<option value="11">11</option>')
  			document.write('<option value="12">12</option>')
  			document.write('<option value="13">13</option>')
  			document.write('<option value="14">14</option>')
  			document.write('<option value="15">15</option>')
  			document.write("</select>")
  			//document.write('<input id = ' + "attackdamage" + i + "" + ' type = "text" />');
  			document.write('<div> Defense </div>');
  			document.write('<select id = ' + "defense" + i + "" + '>')
  			document.write('<option value="1">1</option>')
  			document.write('<option value="2">2</option>')
  			document.write('<option value="3">3</option>')
  			document.write('<option value="4">4</option>')
  			document.write('<option value="5">5</option>')
  			document.write('<option value="6">6</option>')
  			document.write('<option value="7">7</option>')
  			document.write('<option value="8">8</option>')
  			document.write('<option value="9">9</option>')
  			document.write('<option value="10">10</option>')
  			document.write('<option value="11">11</option>')
  			document.write('<option value="12">12</option>')
  			document.write('<option value="13">13</option>')
  			document.write('<option value="14">14</option>')
  			document.write('<option value="15">15</option>')
  			document.write("</select>")
  			//document.write('<input id = ' + "defense"+ i + "" + ' type = "text" />');
  			document.write('<div>');
  			document.write('<button id = ' + "submitfields" + i + "" + ' onclick = "FunctionSubmit(this.id)" type = "submit"> Submit </button');
  			document.write('</div>')
  			document.write('</div>');
}